# SINDARIN file for WHIZARD self test
# Input file for testing user defined amplitudes

?logging = true
?openmp_logging = false
?vis_history = false
?integration_timer = false

!!! Tests should be run single-threaded 
openmp_num_threads = 1

model = SM_tt_threshold
sqrtsmin = 344 GeV
sqrtsmax = 344 GeV
sqrtsstepsize = 0.2 GeV
m1S = 172 GeV

mZ = 91.188
mW = 80.419
mb = 4.2
alphas = 0.118 ! (Z pole, NLL running to mu_h)
alpha_em_i = 125.924 ! (not running)
m1S = 172.0
phs_t_channel = 0

nloop  = 1 # NLL
sh     = 1.
sf     = 1.
Vtb    = 1.
FF     = 1 # NRQCD resummed

me = 0
sqrts = 350 GeV
iterations = 1:1000

seed = 0
process user_prc_threshold_p1 = e1, E1 => Wp, Wm, b, B {$restrictions = "3+5~t && 4+6~tbar"}
integrate (user_prc_threshold_p1)

seed = 0
process user_prc_threshold_p2 = e1, E1 => t, T
integrate (user_prc_threshold_p2)

seed = 0
process user_prc_threshold_p3 = e1, E1 => e2, E2 {$born_me_method = "dummy"}
integrate (user_prc_threshold_p3) { error_threshold = 1E-4 }

seed = 0
process user_prc_threshold_p4 = e1, E1 => Wp, Wm, b, B {$born_me_method = "threshold"}
integrate (user_prc_threshold_p4)
expect (integral(user_prc_threshold_p4) == integral(user_prc_threshold_p1)) {tolerance = 0.0001}

library = "user_prc_threshold_2" ! avoid problem with fixed names in threshold.f90
seed = 0
process user_prc_threshold_p5 = e1, E1 => t, T {$born_me_method = "threshold"}
integrate (user_prc_threshold_p5)
expect (integral(user_prc_threshold_p5) == integral(user_prc_threshold_p2)) {tolerance = 0.0001}
