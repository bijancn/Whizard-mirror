!!! Tests functionality of NLO-setups using all possible combinations of
!!! omega and openloops for Born-, Real- and correlation-matrix-elements.

model = SM ("GF_MW_MZ")
$blha_ew_scheme = "alpha_qed"

?logging = true
?openmp_logging = false
?vis_history = false
?integration_timer = false
?pacify = true
openmp_num_threads = 1

### The OpenLoops version installed might not be new enough to support Collier
?openloops_use_collier = false

!!! Use non default values to easily spot differences
mW = 70
mZ = 90
GF = 1.5E-005
wZ = 1.0
wW = 3.0
printf " alpha_em %g" (1/alpha_em_i)

mmu = 0
me = 0
mc = 0
ms = 0
wtop = 0
mtop = 175 GeV

!!! The expected value for (NLO-LO)/LO is alpha_s / pi
?alpha_s_is_fixed = true
?alpha_s_from_mz = false
?alpha_s_from_lambda_qcd = false
alpha_power = 2
alphas_power = 0

$loop_me_method = "openloops"         !!! Needs OpenLoops library ppllj

sqrts = 500 GeV

iterations = 1:100:"gw"
tolerance = 0.001

show(model)

$born_me_method        = "omega"
$real_tree_me_method   = "omega"
$correlation_me_method = "omega"
process extra_nlo_omomom = E1, e1 => u, U { nlo_calculation = "Full" }
! integrate (extra_nlo_omomom) { seed = 0 }
! show (integral(extra_nlo_omomom))
! show (error(extra_nlo_omomom))
! real reference_integral = integral(extra_nlo_omomom)

$born_me_method        = "openloops"
$real_tree_me_method   = "omega"
$correlation_me_method = "omega"
process extra_nlo_olomom = E1, e1 => u, U { nlo_calculation = "Virtual" }
! integrate (extra_nlo_olomom) { seed = 0 }
show (integral(extra_nlo_olomom))
show (error(extra_nlo_olomom))
! expect (integral (extra_nlo_olomom) == reference_integral)

$born_me_method        = "omega"
$real_tree_me_method   = "openloops"
$correlation_me_method = "omega"
process extra_nlo_omolom = E1, e1 => u, U { nlo_calculation = "Full" }
! integrate (extra_nlo_omolom) { seed = 0 }
! show (integral(extra_nlo_omolom))
! show (error(extra_nlo_omolom))
! expect (integral (extra_nlo_omolom) == reference_integral)

$born_me_method        = "omega"
$real_tree_me_method   = "omega"
$correlation_me_method = "openloops"
process extra_nlo_omomol = E1, e1 => u, U { nlo_calculation = "Virtual" }
integrate (extra_nlo_omomol) { seed = 0 }
show (integral(extra_nlo_omomol))
show (error(extra_nlo_omomol))
! expect (integral (extra_nlo_omomol) == reference_integral)

$born_me_method = "openloops"
$real_tree_me_method = "openloops"
$correlation_me_method = "openloops"
process extra_nlo_ololol = E1, e1 => u, U { nlo_calculation = "Real" }
! integrate (extra_nlo_ololol) { seed = 0 }
! show (integral(extra_nlo_ololol))
! show (error(extra_nlo_ololol))
! expect (integral (extra_nlo_ololol) == reference_integral)
