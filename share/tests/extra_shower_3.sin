!!! Process: Generic tests of Whizar+Shower
!!! Reported by: Mikael Berggren on 2015-06-21
!!! Purpose: 
!!!

model = SM_CKM
?logging = true
?openmp_logging = false
?vis_history = false
?integration_timer = false
openmp_num_threads = 1
sample_format = debug
?debug_decay = false
?debug_process = false
?debug_verbose = false
?write_raw = false
seed = 0

ms = 0
mc = 0
!! issue with mb, flavour-sums, and whizard PS: Make correct choice here !
mb = 0

alias uq = u:U
alias dq = d:D
alias cq = c:C
alias sq = s:S
alias bq = b:B

alias electrons = e1:E1
alias mus = e2:E2
alias taus = e3:E3

alias nu_es = n1:N1
alias nu_mus = n2:N2
alias nu_taus = n3:N3

alias quark = u:d:s:c:b:U:D:S:C:B
alias up_type_q = u:c:U:C
alias down_type_q = d:s:b:D:S:B
alias down_type_q_notb = d:s:D:S

alias lepton = e1:e2:e3:E1:E2:E3
alias not_electron = e2:e3:E2:E3

alias neutrino = n1:n2:n3:N1:N2:N3   
alias not_nu_e = n2:n3:N2:N3

$omega_flags =  "-model:constant_width"
# Z leptonic
process extra_shower_3_z_bhabhag0e = e1,E1 => electrons, electrons, A
process extra_shower_3_z_l0mu   = e1,E1 => mus,mus
process extra_shower_3_z_l0tau  = e1,E1 => taus,taus
process extra_shower_3_z_nu0nu  = e1,E1 => not_nu_e,not_nu_e
process extra_shower_3_z_nu0nue = e1,E1 => nu_es,nu_es

# Z hadronic
process extra_shower_3_z_h0dq   = e1,E1 =>  dq,dq
process extra_shower_3_z_h0sq   = e1,E1 =>  sq,sq
process extra_shower_3_z_h0bq   = e1,E1 =>  bq,bq
process extra_shower_3_z_h0uq   = e1,E1 =>  uq,uq
process extra_shower_3_z_h0cq   = e1,E1 =>  cq,cq

#  dont do this now : 
# z_bhabha0e =    e1,E1 =>  electron,electron
# Z to bosons   
# process ee_zz_o = e1,E1 =>  Z,Z
# process ee_az_o = e1,E1 =>  A,Z
# process ee_aa_o = e1,E1 =>  A,A
# process ee_zh_o = e1,E1 =>  H,Z

# ZZ/WW mix: two flavours ud or cs
process extra_shower_3_zzorww_h0udud   = e1,E1 => uq,dq,dq,uq
process extra_shower_3_zzroww_h0cscs   = e1,E1 => cq,sq,sq,cq

# WW : qq l nu
process extra_shower_3_ww_sl0tauq   =   e1,E1 =>  up_type_q,down_type_q,tau,neutrino
process extra_shower_3_ww_sl0muq    =   e1,E1 =>  up_type_q,down_type_q,mu,neutrino

process extra_shower_3_eett = e1, E1 => t, tbar
process extra_shower_3_eeww = e1, E1 => Wm, Wp
process extra_shower_3_t_dec = t => Wp, b
process extra_shower_3_tb_dec = tbar => Wm, bbar
process extra_shower_3_Wp_dec = Wp => E2, n2
process extra_shower_3_Wm_dec_nb = Wm => up_type_q,down_type_q_notb
process extra_shower_3_Wm_dec_b = Wm => up_type_q,bq

unstable t (extra_shower_3_t_dec)
unstable Wp (extra_shower_3_Wp_dec)
unstable tbar (extra_shower_3_tb_dec)
unstable Wm (extra_shower_3_Wm_dec_nb, extra_shower_3_Wm_dec_b)

compile
sqrts = 500 GeV
iterations = 1:25000:"gw", 5:25000:"g", 1:25000

?keep_remnants = true
?keep_beams = true
?hadronization_active = true
sample_split_n_evt=25000
$extension_stdhep = "stdhep"
sample_format = stdhep

beams = e1, E1 => isr
cuts = all Pt > 5 GeV  and Theta > 10 degree and Theta < 170 degree ["mu+":"mu-"]
?keep_beams = true
?ps_fsr_active = true
$shower_method = "PYTHIA6"
n_events = 1000000
n_events = 10
$sample = "extra_shower_3"
simulate (extra_shower_3_p1)




! OPAL tune:
$ps_PYTHIA_PYGIVE = "MSTJ(28)=0; PMAS(25,1)=120.; PMAS(25,2)=0.3605E-02; MSTJ(41)=2; MSTU(22)=2000; PARJ(21)=0.40000; PARJ(41)=0.11000; PARJ(42)=0.52000; PARJ(81)=0.25000; PARJ(82)=1.90000; MSTJ(11)=3; PARJ(54)=-0.03100; PARJ(55)=-0.00200; PARJ(1)=0.08500; PARJ(3)=0.45000; PARJ(4)=0.02500; PARJ(2)=0.31000; PARJ(11)=0.60000; PARJ(12)=0.40000; PARJ(13)=0.72000; PARJ(14)=0.43000; PARJ(15)=0.08000; PARJ(16)=0.08000; PARJ(17)=0.17000;    MSTP(3)=1;MSTP(71)=1"
!!>>   MSTP(125)=2 mean full pythia output, default means reduced output. Check both  


?ps_fsr_active = true
!!>>  Chech both of these:
$shower_method = "PYTHIA6"
!$shower_method = "WHIZARD"

ps_max_n_flavors = 5
ps_mass_cutoff = 1
ps_fsr_lambda = 0.29

?mlm_matching = true
mlm_nmaxMEjets = 2
mlm_Rmin = 1
mlm_ETclusminE = 10 GeV
real ycut = mlm_ETclusminE**2
cuts = all kT > ycut [j, j]
 


! &parameter_input :
 me = 0
 mmu = 0.10566
 ms = 0
 mc = 0
!! mb = 0
 mH = 2000.
 wH = 10.
 alphas = 1.e-6



!&beam_input :

!>> verfify all combinations (nothing, only cerce1 or circe2 , only isr, both cirece1/2 and isr
beams = e1, E1  => circe1 => isr
$circe2_file="../install/share/circe2/data/ilc500.circe"
$circe2_design="ILC"
?circe2_polarized = false
beams_pol_density = @(-1),@(1)
beams_pol_fraction = 1.0,1.0
isr_alpha = 0.0072993
isr_mass = 0.000511
 



compile


!>> check each
 integrate ( z_l0mu )
!! integrate (z_h0dq) 
!! integrate (z_l0tau)
!! integrate (z_h0bq)
!! integrate (zzorww_h0udud)
!! integrate (ww_sl0muq)
!! integrate (eett)
!! integrate (eeww)
n_events = 10000

?rebuild_events = true
$sample = "z_l0mu_allc1_polb_125def_shopy_17d_10"

checkpoint = 2500

!>> check each
simulate ( z_l0mu )
!!simulate (z_h0dq )
!!simulate ( z_l0tau )
!!simulate ( z_h0bq )
!!simulate ( zzorww_h0udud )
!!simulate ( ww_sl0muq )
!!simulate (eett) 
!!simulate (eeww) 
