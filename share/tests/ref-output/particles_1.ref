* Test output: Particles
*   Purpose: test particle_set routines

* Reading model file

* Initializing production process

* Setup decay process
 Interaction: 1
 Incoming:
 Particle 1
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  4.500000000000E+01
 mask [fch] = [FFgF]
 internal links: X => 3
 Particle 2
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00 -4.500000000000E+01
 mask [fch] = [FFgF]
 internal links: X => 3
 Outgoing:
 Particle 3
 E =   9.000000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  0.000000000000E+00
 mask [fch] = [FFgF]
 internal links: 1 2 => X
 State matrix:  norm =  1.000000000000E+00
 [f(1)]
   [f(-1)]
     [f(23) h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)
     [f(23) h(-1|1)] => ME(2) = ( 0.000000000000E+00, 0.000000000000E+00)
     [f(23) h(1|-1)] => ME(3) = ( 0.000000000000E+00, 0.000000000000E+00)
     [f(23) h(-1)] => ME(4) = ( 0.000000000000E+00, 0.000000000000E+00)
     [f(23) h(0)] => ME(5) = ( 0.000000000000E+00, 0.000000000000E+00)
 Interaction: 2
 Incoming:
 Particle 1
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  4.500000000000E+01
 mask [fch] = [FFgF]
 internal links: X => 2 3
 source: (1)3
 Outgoing:
 Particle 2
 E =   4.500000000000E+01
 P =   0.000000000000E+00  4.500000000000E+01  0.000000000000E+00
 mask [fch] = [FFgF]
 internal links: 1 => X
 Particle 3
 E =   4.500000000000E+01
 P =   0.000000000000E+00 -4.500000000000E+01  0.000000000000E+00
 mask [fch] = [FFgF]
 internal links: 1 => X
 State matrix:  norm =  1.000000000000E+00
 [f(23) h(1)]
   [f(1) c(501 ) h(1)]
     [f(-1) c(-501 ) h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)
 [f(23) h(-1|1)]
   [f(1) c(501 ) h(-1|1)]
     [f(-1) c(-501 ) h(-1|1)] => ME(2) = ( 0.000000000000E+00, 0.000000000000E+00)
 [f(23) h(1|-1)]
   [f(1) c(501 ) h(1|-1)]
     [f(-1) c(-501 ) h(1|-1)] => ME(3) = ( 0.000000000000E+00, 0.000000000000E+00)
 [f(23) h(-1)]
   [f(1) c(501 ) h(-1)]
     [f(-1) c(-501 ) h(-1)] => ME(4) = ( 0.000000000000E+00, 0.000000000000E+00)
 [f(23) h(0)]
   [f(1) c(501 ) h(1)]
     [f(-1) c(-501 ) h(-1)] => ME(5) = ( 0.000000000000E+00, 0.000000000000E+00)
   [f(1) c(501 ) h(1|-1)]
     [f(-1) c(-501 ) h(-1|1)] => ME(6) = ( 0.000000000000E+00, 0.000000000000E+00)
   [f(1) c(501 ) h(-1|1)]
     [f(-1) c(-501 ) h(1|-1)] => ME(7) = ( 0.000000000000E+00, 0.000000000000E+00)
   [f(1) c(501 ) h(-1)]
     [f(-1) c(-501 ) h(1)] => ME(8) = ( 0.000000000000E+00, 0.000000000000E+00)
   [f(2) c(501 ) h(1)]
     [f(-2) c(-501 ) h(-1)] => ME(9) = ( 0.000000000000E+00, 0.000000000000E+00)
   [f(2) c(501 ) h(-1)]
     [f(-2) c(-501 ) h(1)] => ME(10) = ( 0.000000000000E+00, 0.000000000000E+00)

* Concatenate production and decay
 Interaction: 3
 Incoming:
 Particle 1
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  4.500000000000E+01
 mask [fch] = [FFgF]
 internal links: X => 3
 source: (1)1
 Particle 2
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00 -4.500000000000E+01
 mask [fch] = [FFgF]
 internal links: X => 3
 source: (1)2
 Virtual:
 Particle 3[r]
 E =   9.000000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  0.000000000000E+00
 mask [fch] = [FFgF]
 internal links: 1 2 => X => 4 5
 source: (1)3
 Outgoing:
 Particle 4
 E =   4.500000000000E+01
 P =   0.000000000000E+00  4.500000000000E+01  0.000000000000E+00
 mask [fch] = [FFgF]
 internal links: 3 => X
 source: (2)2
 Particle 5
 E =   4.500000000000E+01
 P =   0.000000000000E+00 -4.500000000000E+01  0.000000000000E+00
 mask [fch] = [FFgF]
 internal links: 3 => X
 source: (2)3
 State matrix:  norm =  1.000000000000E+00
 [f(1)]
   [f(-1)]
     [f(23) h(1)]
       [f(1) c(501 ) h(1)]
         [f(-1) c(-501 ) h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)
     [f(23) h(-1|1)]
       [f(1) c(501 ) h(-1|1)]
         [f(-1) c(-501 ) h(-1|1)] => ME(2) = ( 0.000000000000E+00, 0.000000000000E+00)
     [f(23) h(1|-1)]
       [f(1) c(501 ) h(1|-1)]
         [f(-1) c(-501 ) h(1|-1)] => ME(3) = ( 0.000000000000E+00, 0.000000000000E+00)
     [f(23) h(-1)]
       [f(1) c(501 ) h(-1)]
         [f(-1) c(-501 ) h(-1)] => ME(4) = ( 0.000000000000E+00, 0.000000000000E+00)
     [f(23) h(0)]
       [f(1) c(501 ) h(1)]
         [f(-1) c(-501 ) h(-1)] => ME(5) = ( 0.000000000000E+00, 0.000000000000E+00)
       [f(1) c(501 ) h(1|-1)]
         [f(-1) c(-501 ) h(-1|1)] => ME(6) = ( 0.000000000000E+00, 0.000000000000E+00)
       [f(1) c(501 ) h(-1|1)]
         [f(-1) c(-501 ) h(1|-1)] => ME(7) = ( 0.000000000000E+00, 0.000000000000E+00)
       [f(1) c(501 ) h(-1)]
         [f(-1) c(-501 ) h(1)] => ME(8) = ( 0.000000000000E+00, 0.000000000000E+00)
       [f(2) c(501 ) h(1)]
         [f(-2) c(-501 ) h(-1)] => ME(9) = ( 0.000000000000E+00, 0.000000000000E+00)
       [f(2) c(501 ) h(-1)]
         [f(-2) c(-501 ) h(1)] => ME(10) = ( 0.000000000000E+00, 0.000000000000E+00)
 Matrix-element multiplication
  Input interaction 1: 1
  Input interaction 2: 2
  ME(1) =
    + ME1(1) x ME2(1)
  ME(2) =
    + ME1(2) x ME2(2)
  ME(3) =
    + ME1(3) x ME2(3)
  ME(4) =
    + ME1(4) x ME2(4)
  ME(5) =
    + ME1(5) x ME2(5)
  ME(6) =
    + ME1(5) x ME2(6)
  ME(7) =
    + ME1(5) x ME2(7)
  ME(8) =
    + ME1(5) x ME2(8)
  ME(9) =
    + ME1(5) x ME2(9)
  ME(10) =
    + ME1(5) x ME2(10)

* Factorize as subevent (complete, polarized)

 Particle set:
------------------------------------------------------------------------
 Particle 1 [i] f(1)
 Polarization: [spin_type = 2, mult = 2]
 State matrix:  norm =  1.000000000000E+00
 [] => ME(1) = ( 5.000000000000E-01, 0.000000000000E+00)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  4.500000000000E+01
 T =   0.000000000000E+00
 Children: 3
 Particle 2 [i] f(-1)
 Polarization: [spin_type = 2, mult = 2]
 State matrix:  norm =  1.000000000000E+00
 [] => ME(1) = ( 5.000000000000E-01, 0.000000000000E+00)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00 -4.500000000000E+01
 T =   0.000000000000E+00
 Children: 3
 Particle 3 [r] f(23)
 Polarization: [spin_type = 3, mult = 3]
 State matrix:  norm =  1.000000000000E+00
 [h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)
 E =   9.000000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  0.000000000000E+00
 T =   8.100000000000E+03
 Parents:  1 2
 Children: 4 5
 Particle 4 [o] f(1)c(501 )
 Polarization: [spin_type = 2, mult = 2]
 State matrix:  norm =  1.000000000000E+00
 [h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  4.500000000000E+01  0.000000000000E+00
 T =   0.000000000000E+00
 Parents:  3
 Particle 5 [o] f(-1)c(-501 )
 Polarization: [spin_type = 2, mult = 2]
 State matrix:  norm =  1.000000000000E+00
 [h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)
 E =   4.500000000000E+01
 P =   0.000000000000E+00 -4.500000000000E+01  0.000000000000E+00
 T =   0.000000000000E+00
 Parents:  3

* Factorize as subevent (in/out only, selected helicity)

 Particle set:
------------------------------------------------------------------------
 Particle 1 [i] f(1)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  4.500000000000E+01
 T =   0.000000000000E+00
 Particle 2 [i] f(-1)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00 -4.500000000000E+01
 T =   0.000000000000E+00
 Particle 3 [o] f(1)c(501 )h(1)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  4.500000000000E+01  0.000000000000E+00
 T =   0.000000000000E+00
 Particle 4 [o] f(-1)c(-501 )h(1)
 E =   4.500000000000E+01
 P =   0.000000000000E+00 -4.500000000000E+01  0.000000000000E+00
 T =   0.000000000000E+00

* Factorize as subevent (complete, selected helicity)

 Particle set:
------------------------------------------------------------------------
 Particle 1 [i] f(1)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  4.500000000000E+01
 T =   0.000000000000E+00
 Children: 3
 Particle 2 [i] f(-1)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00 -4.500000000000E+01
 T =   0.000000000000E+00
 Children: 3
 Particle 3 [r] f(23)h(1)
 E =   9.000000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  0.000000000000E+00
 T =   8.100000000000E+03
 Parents:  1 2
 Children: 4 5
 Particle 4 [o] f(1)c(501 )h(1)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  4.500000000000E+01  0.000000000000E+00
 T =   0.000000000000E+00
 Parents:  3
 Particle 5 [o] f(-1)c(-501 )h(1)
 E =   4.500000000000E+01
 P =   0.000000000000E+00 -4.500000000000E+01  0.000000000000E+00
 T =   0.000000000000E+00
 Parents:  3

* Factorize (complete, polarized, correlated); write and read again

 Particle set:
------------------------------------------------------------------------
 Particle 1 [i] f(1)
 Polarization: [spin_type = 2, mult = 2]
 State matrix:  norm =  1.000000000000E+00
 [] => ME(1) = ( 5.000000000000E-01, 0.000000000000E+00)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  4.500000000000E+01
 T =   0.000000000000E+00
 Children: 3
 Particle 2 [i] f(-1)
 Polarization: [spin_type = 2, mult = 2]
 State matrix:  norm =  1.000000000000E+00
 [] => ME(1) = ( 5.000000000000E-01, 0.000000000000E+00)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00 -4.500000000000E+01
 T =   0.000000000000E+00
 Children: 3
 Particle 3 [r] f(23)
 Polarization: [spin_type = 3, mult = 3]
 State matrix:  norm =  1.000000000000E+00
 [h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)
 E =   9.000000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  0.000000000000E+00
 T =   8.100000000000E+03
 Parents:  1 2
 Children: 4 5
 Particle 4 [o] f(1)c(501 )
 Polarization: [spin_type = 2, mult = 2]
 State matrix:  norm =  1.000000000000E+00
 [h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  4.500000000000E+01  0.000000000000E+00
 T =   0.000000000000E+00
 Parents:  3
 Particle 5 [o] f(-1)c(-501 )
 Polarization: [spin_type = 2, mult = 2]
 State matrix:  norm =  1.000000000000E+00
 [h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)
 E =   4.500000000000E+01
 P =   0.000000000000E+00 -4.500000000000E+01  0.000000000000E+00
 T =   0.000000000000E+00
 Parents:  3
------------------------------------------------------------------------
 Correlated state density matrix:
 State matrix:  norm =  1.000000000000E+00
 [f(1)]
   [f(-1)]
     [f(23) h(1)]
       [f(1) c(501 ) h(1)]
         [f(-1) c(-501 ) h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)

* Result from reading

 Particle set:
------------------------------------------------------------------------
 Particle 1 [i] f(1)
 Polarization: [spin_type = 2, mult = 2]
 State matrix:  norm =  1.000000000000E+00
 [] => ME(1) = ( 5.000000000000E-01, 0.000000000000E+00)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  4.500000000000E+01
 T =   0.000000000000E+00
 Children: 3
 Particle 2 [i] f(-1)
 Polarization: [spin_type = 2, mult = 2]
 State matrix:  norm =  1.000000000000E+00
 [] => ME(1) = ( 5.000000000000E-01, 0.000000000000E+00)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00 -4.500000000000E+01
 T =   0.000000000000E+00
 Children: 3
 Particle 3 [r] f(23)
 Polarization: [spin_type = 3, mult = 3]
 State matrix:  norm =  1.000000000000E+00
 [h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)
 E =   9.000000000000E+01
 P =   0.000000000000E+00  0.000000000000E+00  0.000000000000E+00
 T =   8.100000000000E+03
 Parents:  1 2
 Children: 4 5
 Particle 4 [o] f(1)c(501 )
 Polarization: [spin_type = 2, mult = 2]
 State matrix:  norm =  1.000000000000E+00
 [h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)
 E =   4.500000000000E+01
 P =   0.000000000000E+00  4.500000000000E+01  0.000000000000E+00
 T =   0.000000000000E+00
 Parents:  3
 Particle 5 [o] f(-1)c(-501 )
 Polarization: [spin_type = 2, mult = 2]
 State matrix:  norm =  1.000000000000E+00
 [h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)
 E =   4.500000000000E+01
 P =   0.000000000000E+00 -4.500000000000E+01  0.000000000000E+00
 T =   0.000000000000E+00
 Parents:  3
------------------------------------------------------------------------
 Correlated state density matrix:
 State matrix:  norm =  1.000000000000E+00
 [f(1)]
   [f(-1)]
     [f(23) h(1)]
       [f(1) c(501 ) h(1)]
         [f(-1) c(-501 ) h(1)] => ME(1) = ( 0.000000000000E+00, 0.000000000000E+00)

* Transform to a subevt object

 subevent:
 1 prt(i:1|-4.5000000E+01; 0.0000000E+00, 0.0000000E+00,-4.5000000E+01| 0.000000000000E+00| 1)
 2 prt(i:-1|-4.5000000E+01; 0.0000000E+00, 0.0000000E+00, 4.5000000E+01| 0.000000000000E+00| 2)
 3 prt(o:1| 4.5000000E+01; 0.0000000E+00, 4.5000000E+01, 0.0000000E+00| 0.000000000000E+00| 3)
 4 prt(o:-1| 4.5000000E+01; 0.0000000E+00,-4.5000000E+01, 0.0000000E+00| 0.000000000000E+00| 4)

* Cleanup

* Test output end: particles_1
